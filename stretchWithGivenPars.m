% Function that rescales input array with given minimum and maximum.%  INPUT:%    im: Input array.%    scale: Maximum and minimum.%    pars: Pars variable.%  OUTPUT:%    renormalized: Rescaled input array.function [renormalized] = stretchWithGivenPars(im,scale,pars)minValue = 0;range = 1;if (exist('scale', 'var'))	minValue = scale(1);	range = abs(scale(2) - scale(1));endim = double(im); [a,b] = size(im);if(b==1)    if(size(pars) == [1 2])        renormalized = range * (im - pars(1,1)) ./ (pars(1,2)-pars(1,1)) + minValue;    else        error('Parameters do not fit time series');    endelse    renormalized = zeros(a,b);    for i = 1:b        renormalized(:,i) = range * (im(:,i) - pars(i,1)) ./ (pars(i,2)-pars(i,1)) + minValue;    endend